SELECT count(v.vn) as visit,COUNT(DISTINCT(v.hn)) as hn

FROM vn_stat v
INNER JOIN opitemrece o ON o.vn = v.vn
INNER JOIN drugitems d  ON d.icode = o.icode 
where v.vstdate BETWEEN 20150901 AND 20160831
and v.pdx Like "J00%"
and d.did in ('100090000001350410181506','100090000001480710181562','100176000004493120181506','100176000000950330681621','210010310017758110281329',
'210010310018544130681078','210010310018473121781175','100176000004293220181506','100145000002620110281625','100145000004292210281625',
'124824000004293220181506','100118000004292210281562','124835000004021220181247','101284000004021220181247','100125000004494110281189',
'100131000002620110181095','100133000002620110281539','100180000000590110181479','100180000004293220381445','100207000001390510181247',
'100207000004121120181506','100153000004494110281084','100153000004293220181472','210010500017408130481506','100173000004493120181307',
'100153000000950330681606','100173000004293220181307','100191000004021220481099','100141270004293220381079','100141105000950330681099',
'124893000002620110281247','100275000004410220381247','100275000000700610181473','140980000003972120181506','140980000003771120181506',
'140980000001501120181506','100150000005840110281472','100152000004293220381506','100143000004121121781606','210010500018320120381506')

UNION ALL

SELECT count(v.vn) as visit,COUNT(DISTINCT(v.hn)) as hn

FROM an_stat v
INNER JOIN opitemrece o ON o.an = v.an
INNER JOIN drugitems d  ON d.icode = o.icode 
where v.regdate BETWEEN 20150901 AND 20160831
and v.pdx Like "J00%"
and d.did in ('100090000001350410181506','100090000001480710181562','100176000004493120181506','100176000000950330681621','210010310017758110281329',
'210010310018544130681078','210010310018473121781175','100176000004293220181506','100145000002620110281625','100145000004292210281625',
'124824000004293220181506','100118000004292210281562','124835000004021220181247','101284000004021220181247','100125000004494110281189',
'100131000002620110181095','100133000002620110281539','100180000000590110181479','100180000004293220381445','100207000001390510181247',
'100207000004121120181506','100153000004494110281084','100153000004293220181472','210010500017408130481506','100173000004493120181307',
'100153000000950330681606','100173000004293220181307','100191000004021220481099','100141270004293220381079','100141105000950330681099',
'124893000002620110281247','100275000004410220381247','100275000000700610181473','140980000003972120181506','140980000003771120181506',
'140980000001501120181506','100150000005840110281472','100152000004293220381506','100143000004121121781606','210010500018320120381506')
